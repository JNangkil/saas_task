<section class="workspace-overview" *ngIf="hasAnyWorkspace(); else emptyState">
  <header class="workspace-overview__hero" *ngIf="activeWorkspace() as workspace">
    <div class="workspace-overview__hero-content">
      <span class="workspace-overview__hero-chip">Workspace overview</span>
      <h1 class="workspace-overview__hero-title">{{ workspace.name }}</h1>
      <p class="workspace-overview__hero-subtitle">
        Welcome back! Track work, docs, and teammates from this command center inspired by the ClickUp workspace hub.
      </p>

      <div class="workspace-overview__hero-actions" role="group" aria-label="Workspace quick actions">
        <button type="button" class="workspace-overview__primary" (click)="goToMembers()">Invite people</button>
        <button type="button" class="workspace-overview__ghost" (click)="goToSettings()">Workspace settings</button>
      </div>

      <div
        *ngIf="statusMessage() as status"
        class="workspace-overview__status"
        [class.workspace-overview__status--success]="status.type === 'success'"
        [class.workspace-overview__status--error]="status.type === 'error'"
        role="status"
        aria-live="polite"
      >
        {{ status.text }}
      </div>
    </div>

    <aside class="workspace-overview__plan" aria-label="Workspace plan summary">
      <h2 class="workspace-overview__plan-title">{{ billingSummary().planName }}</h2>
      <p class="workspace-overview__plan-meta">
        {{ billingSummary().seatsUsed }} of {{ billingSummary().seatsTotal }} seats used
      </p>
      <p class="workspace-overview__plan-meta">Next invoice on {{ billingSummary().nextInvoiceDate }}</p>
      <button type="button" class="workspace-overview__ghost workspace-overview__ghost--contrast" (click)="goToBilling()">
        Manage billing
      </button>
    </aside>
  </header>

  <section class="workspace-overview__metrics" aria-label="Workspace highlights">
    <article
      class="workspace-overview__metric"
      *ngFor="let metric of workspaceMetrics(); trackBy: trackByIndex; let i = index"
      [attr.data-index]="i"
    >
      <span class="workspace-overview__metric-label">{{ metric.label }}</span>
      <strong class="workspace-overview__metric-value">{{ metric.value }}</strong>
      <span class="workspace-overview__metric-delta">{{ metric.delta }}</span>
    </article>
  </section>

  <div class="workspace-overview__grid">
    <section class="workspace-overview__column workspace-overview__column--primary">
      <article
        class="workspace-overview__card workspace-overview__card--hierarchy"
        *ngIf="workspaceHierarchy() as hierarchy"
      >
        <header class="workspace-overview__card-header">
          <div>
            <h2 class="workspace-overview__card-title">Workspace structure map</h2>
            <p class="workspace-overview__card-subtitle">
              Visualize how ClickUp scopes work from workspace to the tasks your team ships every day.
            </p>
          </div>
        </header>

        <tf-workspace-hierarchy-map [hierarchy]="hierarchy"></tf-workspace-hierarchy-map>

        <p class="workspace-overview__hierarchy-note">
          Start at the workspace to manage people and billing, drop into spaces for each department, then drive execution
          through folders, lists, and tasks. Every level narrows the focus so teams stay organized without losing the big
          picture.
        </p>
      </article>

      <article class="workspace-overview__card workspace-overview__card--checklist">
        <header class="workspace-overview__card-header">
          <div>
            <h2 class="workspace-overview__card-title">Kickstart your workspace</h2>
            <p class="workspace-overview__card-subtitle">A quick checklist to mirror ClickUp’s onboarding flow.</p>
          </div>
        </header>
        <ul class="workspace-overview__checklist" role="list">
          <li class="workspace-overview__checklist-item" *ngFor="let step of quickStartItems(); trackBy: trackByIndex">
            <span class="workspace-overview__checklist-status" [class.is-complete]="step.done" aria-hidden="true"></span>
            <div class="workspace-overview__checklist-body">
              <span class="workspace-overview__checklist-title">{{ step.label }}</span>
              <p class="workspace-overview__checklist-description">{{ step.description }}</p>
            </div>
            <button
              *ngIf="step.action"
              type="button"
              class="workspace-overview__ghost workspace-overview__ghost--sm"
              (click)="step.action()"
            >
              Open
            </button>
            <span *ngIf="!step.action" class="workspace-overview__checklist-hint">Done</span>
          </li>
        </ul>
      </article>

      <article class="workspace-overview__card workspace-overview__card--activity">
        <header class="workspace-overview__card-header">
          <div>
            <h2 class="workspace-overview__card-title">Latest activity</h2>
            <p class="workspace-overview__card-subtitle">
              Mirrors the live pulse inside ClickUp with real-time updates from your team.
            </p>
          </div>
        </header>
        <ul class="workspace-overview__activity" role="list">
          <li class="workspace-overview__activity-item" *ngFor="let entry of activityFeed(); trackBy: trackByIndex">
            <span class="workspace-overview__activity-time">{{ entry.time }}</span>
            <div class="workspace-overview__activity-body">
              <strong class="workspace-overview__activity-actor">{{ entry.actor }}</strong>
              <p class="workspace-overview__activity-action">{{ entry.action }}</p>
            </div>
          </li>
        </ul>
      </article>
    </section>

    <section class="workspace-overview__column workspace-overview__column--secondary">
      <article class="workspace-overview__card workspace-overview__card--members">
        <header class="workspace-overview__card-header">
          <div>
            <h2 class="workspace-overview__card-title">People</h2>
            <p class="workspace-overview__card-subtitle">All the collaborators who have access to this workspace.</p>
          </div>
          <button type="button" class="workspace-overview__ghost workspace-overview__ghost--sm" (click)="goToMembers()">
            Manage
          </button>
        </header>
        <ul class="workspace-overview__people" role="list">
          <li class="workspace-overview__people-item" *ngFor="let member of workspaceMembers(); trackBy: trackByIndex">
            <span class="workspace-overview__avatar" aria-hidden="true">{{ member.initials }}</span>
            <div class="workspace-overview__people-body">
              <span class="workspace-overview__people-name">{{ member.name }}</span>
              <span class="workspace-overview__people-role">{{ member.role }}</span>
            </div>
            <span class="workspace-overview__people-status" [attr.data-status]="member.status">{{ member.status }}</span>
          </li>
        </ul>
      </article>

      <article class="workspace-overview__card workspace-overview__card--shortcuts">
        <header class="workspace-overview__card-header">
          <div>
            <h2 class="workspace-overview__card-title">Pinned shortcuts</h2>
            <p class="workspace-overview__card-subtitle">
              Jump straight into your most important ClickUp spaces, docs, and boards.
            </p>
          </div>
        </header>
        <ul class="workspace-overview__shortcuts" role="list">
          <li class="workspace-overview__shortcut" *ngFor="let shortcut of workspaceShortcuts(); trackBy: trackByIndex">
            <span class="workspace-overview__shortcut-icon" aria-hidden="true">{{ shortcut.icon }}</span>
            <div class="workspace-overview__shortcut-body">
              <span class="workspace-overview__shortcut-name">{{ shortcut.name }}</span>
              <span class="workspace-overview__shortcut-description">{{ shortcut.description }}</span>
            </div>
            <a class="workspace-overview__shortcut-link" [routerLink]="shortcut.link">Open</a>
          </li>
        </ul>
      </article>

      <article class="workspace-overview__card workspace-overview__card--docs">
        <header class="workspace-overview__card-header">
          <div>
            <h2 class="workspace-overview__card-title">Recent docs</h2>
            <p class="workspace-overview__card-subtitle">Keep high-signal documents within reach.</p>
          </div>
          <button type="button" class="workspace-overview__ghost workspace-overview__ghost--sm">Open Docs</button>
        </header>
        <ul class="workspace-overview__docs" role="list">
          <li class="workspace-overview__doc" *ngFor="let doc of recentDocs(); trackBy: trackByIndex">
            <span class="workspace-overview__doc-pill">{{ doc.type }}</span>
            <div class="workspace-overview__doc-body">
              <span class="workspace-overview__doc-title">{{ doc.title }}</span>
              <span class="workspace-overview__doc-updated">Updated {{ doc.updated }}</span>
            </div>
          </li>
        </ul>
      </article>
    </section>
  </div>

  <section class="workspace-overview__workspace-switcher" *ngIf="hasMultipleWorkspaces()">
    <header class="workspace-overview__card-header">
      <div>
        <h2 class="workspace-overview__card-title">Switch workspaces</h2>
        <p class="workspace-overview__card-subtitle">
          Choose another workspace or create a new one—just like the ClickUp workspace picker.
        </p>
      </div>
      <button type="button" class="workspace-overview__ghost workspace-overview__ghost--sm" (click)="startWorkspaceCreation()">
        New workspace
      </button>
    </header>
    <div class="workspace-overview__workspace-list">
      <button
        type="button"
        class="workspace-overview__workspace"
        *ngFor="let workspaceItem of workspaces(); trackBy: trackByWorkspaceId"
        [class.is-active]="workspaceItem.id === activeWorkspaceId()"
        (click)="handleSelectWorkspace(workspaceItem.id)"
      >
        <span class="workspace-overview__workspace-initials">{{ workspaceInitials(workspaceItem.name) }}</span>
        <div class="workspace-overview__workspace-meta">
          <span class="workspace-overview__workspace-name">{{ workspaceItem.name }}</span>
          <span class="workspace-overview__workspace-role">{{ workspaceItem.membershipRole }} access</span>
        </div>
      </button>
    </div>
  </section>

  <section class="workspace-overview__create" *ngIf="isCreating()">
    <div class="workspace-overview__create-panel">
      <header class="workspace-overview__card-header">
        <div>
          <h2 class="workspace-overview__card-title">Create a new workspace</h2>
          <p class="workspace-overview__card-subtitle">Name it, set the locale, and invite collaborators.</p>
        </div>
        <button type="button" class="workspace-overview__ghost workspace-overview__ghost--sm" (click)="cancelWorkspaceCreation()">
          Cancel
        </button>
      </header>
      <tf-workspace-settings-form
        mode="create"
        [saving]="isSaving()"
        [error]="submitError()"
        (create)="handleCreateWorkspace($event)"
      ></tf-workspace-settings-form>
    </div>
  </section>
</section>

<ng-template #emptyState>
  <section class="workspace-overview workspace-overview--empty">
    <header class="workspace-overview__hero workspace-overview__hero--empty">
      <span class="workspace-overview__hero-chip">Workspace overview</span>
      <h1 class="workspace-overview__hero-title">Create your first workspace</h1>
      <p class="workspace-overview__hero-subtitle">
        ClickUp-style workspaces keep projects, docs, and reporting scoped to the right team. Set one up to get the
        full experience.
      </p>
    </header>

    <section class="workspace-overview__card workspace-overview__card--create">
      <tf-workspace-settings-form
        mode="create"
        [saving]="isSaving()"
        [error]="submitError()"
        (create)="handleCreateWorkspace($event)"
      ></tf-workspace-settings-form>
    </section>
  </section>
</ng-template>
