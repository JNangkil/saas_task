<section class="workspace-hub" *ngIf="hasAnyWorkspace(); else emptyState">
  <ng-container *ngIf="primaryWorkspace() as workspace">
    <header class="workspace-hub__hero">
      <div class="workspace-hub__hero-meta">
        <span class="workspace-hub__hero-chip">Active workspace</span>
        <h1 class="workspace-hub__hero-title">{{ workspace.name }}</h1>
        <p class="workspace-hub__hero-subtitle">
          You're the {{ workspace.membershipRole | lowercase }} here. Invite teammates, adjust billing, or
          tweak settings without losing your place.
        </p>
        <div class="workspace-hub__hero-actions">
          <button type="button" (click)="goToMembers()">Invite teammates</button>
          <button type="button" (click)="goToSettings()">Workspace settings</button>
          <button type="button" (click)="goToBilling()">Billing &amp; usage</button>
        </div>
      </div>
    </header>
  </ng-container>

  <section
    class="workspace-hub__status"
    *ngIf="statusMessage() as message"
    [class.workspace-hub__status--success]="message.type === 'success'"
    [class.workspace-hub__status--error]="message.type === 'error'"
  >
    {{ message.text }}
  </section>

  <div class="workspace-hub__grid">
    <article class="workspace-hub__card workspace-hub__card--catalog">
      <header class="workspace-hub__card-header">
        <div>
          <h2 class="workspace-hub__card-title">Your workspaces</h2>
          <p class="workspace-hub__card-subtitle" *ngIf="hasMultipleWorkspaces(); else singleWorkspaceCopy">
            Switch between workspaces without losing context. Pick one to jump straight into its overview.
          </p>
          <ng-template #singleWorkspaceCopy>
            <p class="workspace-hub__card-subtitle">
              You're all set with your current workspace. Create another if you collaborate with a different team.
            </p>
          </ng-template>
        </div>
        <button type="button" class="workspace-hub__ghost-button" (click)="startWorkspaceCreation()">
          New workspace
        </button>
      </header>

      <div class="workspace-hub__tiles" *ngIf="workspaces().length">
        <button
          type="button"
          class="workspace-hub__tile"
          *ngFor="let workspace of workspaces(); trackBy: trackByWorkspaceId"
          [class.workspace-hub__tile--active]="workspace.id === primaryWorkspaceId()"
          (click)="handleSelectWorkspace(workspace.id)"
          [attr.aria-current]="workspace.id === primaryWorkspaceId() ? 'page' : null"
        >
          <span class="workspace-hub__tile-initials">{{ workspaceInitials(workspace.name) }}</span>
          <span class="workspace-hub__tile-body">
            <span class="workspace-hub__tile-name">{{ workspace.name }}</span>
            <span class="workspace-hub__tile-meta">
              {{ workspace.membershipRole }} â€¢ Created {{ workspace.createdAt | date: 'MMM d, y' }}
            </span>
          </span>
          <span class="workspace-hub__tile-arrow" aria-hidden="true"></span>
        </button>
      </div>
    </article>

    <article
      class="workspace-hub__card workspace-hub__card--create"
      [class.workspace-hub__card--open]="isCreating()"
    >
      <ng-container *ngIf="isCreating(); else createPrompt">
        <header class="workspace-hub__card-header">
          <h2 class="workspace-hub__card-title">Start a new workspace</h2>
          <p class="workspace-hub__card-subtitle">
            Give it a name, pick a default language, and add a mark so teammates recognize it instantly.
          </p>
        </header>
        <tf-workspace-settings-form
          mode="create"
          [saving]="isSaving()"
          [error]="submitError()"
          (create)="handleCreateWorkspace($event)"
        ></tf-workspace-settings-form>
        <button
          type="button"
          class="workspace-hub__ghost-button workspace-hub__ghost-button--muted"
          (click)="cancelWorkspaceCreation()"
          [disabled]="isSaving()"
        >
          Cancel
        </button>
      </ng-container>
      <ng-template #createPrompt>
        <header class="workspace-hub__card-header">
          <h2 class="workspace-hub__card-title">Need a fresh space?</h2>
          <p class="workspace-hub__card-subtitle">
            Spin up a workspace for a new client, department, or internal experiment without disrupting your current flow.
          </p>
        </header>
        <button type="button" class="workspace-hub__primary-button" (click)="startWorkspaceCreation()">
          Create workspace
        </button>
      </ng-template>
    </article>

    <article class="workspace-hub__card workspace-hub__card--summary" *ngIf="primaryWorkspace()">
      <header class="workspace-hub__card-header">
        <h2 class="workspace-hub__card-title">Billing snapshot</h2>
        <p class="workspace-hub__card-subtitle">
          Keep an eye on seats and renewal dates before they sneak up on you.
        </p>
      </header>
      <tf-workspace-billing-summary
        [summary]="billingSummary()"
      ></tf-workspace-billing-summary>
      <button type="button" class="workspace-hub__ghost-button" (click)="goToBilling()">
        Open billing center
      </button>
    </article>

    <article class="workspace-hub__card workspace-hub__card--insights">
      <h2 class="workspace-hub__card-title">Workspace playbook</h2>
      <ul class="workspace-hub__guides">
        <li>Share the workspace with your core team and invite stakeholders as viewers.</li>
        <li>Keep spaces aligned to your departments so reporting stays meaningful.</li>
        <li>Set up recurring check-ins from the dashboard once a week.</li>
      </ul>
    </article>
  </div>
</section>

<ng-template #emptyState>
  <section class="workspace-hub workspace-hub--empty">
    <header class="workspace-hub__hero workspace-hub__hero--empty">
      <span class="workspace-hub__hero-chip">Workspace hub</span>
      <h1 class="workspace-hub__hero-title">Create your first workspace</h1>
      <p class="workspace-hub__hero-subtitle">
        Workspaces keep projects, reporting, and members scoped to the right audience. Name it, choose a language, and invite collaborators.
      </p>
    </header>

    <section class="workspace-hub__card workspace-hub__card--create workspace-hub__card--open">
      <tf-workspace-settings-form
        mode="create"
        [saving]="isSaving()"
        [error]="submitError()"
        (create)="handleCreateWorkspace($event)"
      ></tf-workspace-settings-form>
    </section>
  </section>
</ng-template>
