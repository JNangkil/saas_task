<div class="h-full flex flex-col">
    <!-- Days Header -->
    <div class="grid grid-cols-7 border-b border-gray-200 ml-16">
        <div *ngFor="let day of weekDays" class="py-2 text-center border-l border-gray-200 first:border-l-0">
            <div class="text-xs font-semibold text-gray-500 uppercase">{{day.date | date:'EEE'}}</div>
            <div class="text-lg font-medium" [class.text-blue-600]="day.isToday" [class.bg-blue-50]="day.isToday"
                [class.w-8]="day.isToday" [class.h-8]="day.isToday" [class.rounded-full]="day.isToday"
                [class.mx-auto]="day.isToday" [class.flex]="day.isToday" [class.items-center]="day.isToday"
                [class.justify-center]="day.isToday">
                {{day.date | date:'d'}}
            </div>
        </div>
    </div>

    <!-- Scrollable Grid -->
    <div class="flex-1 overflow-y-auto relative bg-white">
        <!-- Time Axis -->
        <div class="absolute left-0 top-0 bottom-0 w-16 border-r border-gray-200 bg-white z-10">
            <!-- Placeholder for time slots if we had hourly -->
            <div class="p-2 text-xs text-center text-gray-400">All Day</div>
        </div>

        <!-- Week Grid -->
        <div class="grid grid-cols-7 ml-16 min-h-full" cdkDropListGroup>
            <div *ngFor="let day of weekDays" class="border-l border-gray-200 first:border-l-0 p-1 min-h-[500px]"
                [class.bg-blue-50]="day.isToday">

                <!-- Tasks List -->
                <div class="space-y-2 h-full" cdkDropList [cdkDropListData]="day.tasks" [id]="day.id"
                    (cdkDropListDropped)="onDrop($event, day.id)">

                    <div *ngFor="let task of day.tasks" cdkDrag [cdkDragData]="task" (click)="onTaskClick(task, $event)"
                        class="bg-white p-2 rounded shadow-sm border border-gray-200 cursor-pointer hover:border-blue-300 group">

                        <div class="flex items-start justify-between gap-1 mb-1">
                            <span class="text-sm font-medium text-gray-900 line-clamp-2">{{task.title}}</span>
                            <div class="w-2 h-2 rounded-full flex-shrink-0 mt-1.5"
                                [class.bg-red-500]="task.priority === 'urgent' || task.priority === 'high'"
                                [class.bg-orange-500]="task.priority === 'medium'"
                                [class.bg-green-500]="task.priority === 'low'" [class.bg-blue-500]="!task.priority">
                            </div>
                        </div>

                        <div class="flex items-center gap-2 text-xs text-gray-500">
                            <img *ngIf="task.assignee" [src]="task.assignee.avatar_url || 'assets/default-avatar.png'"
                                class="w-4 h-4 rounded-full">
                            <span *ngIf="task.project" class="truncate max-w-[80px]">{{task.project.name}}</span>
                        </div>

                        <!-- Drag Preview -->
                        <div *cdkDragPreview
                            class="bg-white p-2 rounded shadow-lg border border-blue-200 w-56 opacity-90 z-50">
                            <span class="text-sm font-medium text-gray-900">{{task.title}}</span>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>