<div class="security-log">
    <!-- Loading State -->
    <div class="text-center py-4" *ngIf="isLoading">
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2 text-muted">Loading security logs...</p>
    </div>

    <!-- Logs List -->
    <div *ngIf="!isLoading">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="mb-0">Security Activity Log</h6>
            <small class="text-muted">Showing recent security events</small>
        </div>

        <!-- No Logs -->
        <div class="alert alert-info" *ngIf="logs.length === 0">
            <i class="bi bi-info-circle me-2"></i>
            No security events found.
        </div>

        <!-- Logs Timeline -->
        <div class="log-timeline">
            <div class="log-entry {{ getLogEntryClass(entry) }}" *ngFor="let entry of logs">
                <div class="log-icon">
                    <i class="bi" [ngClass]="getEventIcon(entry)"></i>
                </div>
                <div class="log-content">
                    <div class="log-header">
                        <span class="event-type">{{ getEventType(entry) }}</span>
                        <span class="log-time">{{ getFormattedDate(entry.created_at) }}</span>
                    </div>
                    <div class="log-description">
                        {{ getEventDescription(entry) }}
                    </div>
                    <div class="log-meta" *ngIf="entry.ip_address">
                        <small class="text-muted">
                            <i class="bi bi-geo-alt me-1"></i>
                            IP: {{ entry.ip_address }}
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Load More Button -->
        <div class="text-center mt-4" *ngIf="hasMoreLogs()">
            <button class="btn btn-outline-primary" (click)="onLoadMore()">
                <i class="bi bi-arrow-clockwise me-1"></i>
                Load More
            </button>
        </div>

        <!-- Log Info -->
        <div class="alert alert-info mt-3">
            <i class="bi bi-info-circle me-2"></i>
            <strong>About Security Logs:</strong>
            <ul class="mb-0 mt-2">
                <li>Security events are logged for important account activities.</li>
                <li>Logs are retained for 90 days.</li>
                <li>Failed login attempts and account lockouts are included.</li>
                <li>IP addresses and device information are recorded when available.</li>
            </ul>
        </div>
    </div>
</div>